<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/public/getyour-logo.svg" />
    <title>Startseite</title>

    <style>
      body {
        margin: 0;
        overscroll-behavior: none;
      }
      
      div.button:hover {
        outline: 3px solid #999;
      }
    </style>

  </head>
  <body>



    <script type="module">
      import {Helper} from "/js/Helper.js"

      Helper.convert("parent/dark", document.body)

      Helper.headerPicker("back", document.body)

      const openClosedButton = Helper.create("button/getyour", document.body)
      openClosedButton.onclick = () => {
        Helper.overlay("popup", async overlay => {
          Helper.add("button/remove-overlay", overlay)

          const content = Helper.create("div/scrollable", overlay)

          try {

            const res = await Helper.verifyIs("user/closed")

            if (res.status === 200) {
              Helper.render("text/hr", "closed apps", content)

              const closedButtons = Helper.create("div/scrollable", content)
              Helper.add("button/network", closedButtons)

              Helper.add("button/assign-expert-home", closedButtons)

              const res = await Helper.verifyIs("user/getyour-admin")
              if (res.status === 200) {
                const button = Helper.create("button/left-right", closedButtons)
                button.left.innerHTML = ".admin"
                button.right.innerHTML = "Der Bereich für Admins"
                button.onclick = () => window.location.assign("/admin/")
              }

            }

            Helper.render("text/hr", "open apps", content)
            Helper.create("nav/open", content)

          } catch (error) {

            Helper.render("text/hr", "open apps", content)
            Helper.create("nav/open", content)
          }




        })
      }


      Helper.render("text/title", "Zugangspunkte", document.body)

      {
        const buttons = Helper.headerPicker("loading", document.body)

        const get = {}
        get.url = "/get/experts/open/"
        const res = await Helper.request("open/json", get)

        if (res.status !== 200) {

          Helper.convert("parent/info", buttons)

          buttons.innerHTML = `<span style="margin: 21px 34px;">Schon bald werden hier Zugänge für dich zur Verfügung stehen.</span>`
          throw new Error("expert not found")

        }

        if (res.status === 200) {
          const experts = JSON.parse(res.response)

          if (experts.length === 0) {

            Helper.convert("parent/info", buttons)

            buttons.innerHTML = `<span style="margin: 21px 34px;">Schon bald werden hier Zugänge für dich zur Verfügung stehen.</span>`
            throw new Error("expert not found")

          }

          Helper.render("experts/open", experts, buttons)

        }
      }

    </script>

  </body>
</html>

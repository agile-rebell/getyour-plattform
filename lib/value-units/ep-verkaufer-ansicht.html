<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />


    <link rel="shortcut icon" href="/public/getyour-logo.svg" />
    <title>Energie Plattform Verkäufer Ansicht</title>



    <style>
      body {
        margin: 0;
        line-height: 1.2;
        font-family: sans-serif;
      }
    </style>

  </head>
  <body>

    <header></header>

    <h1 class="title"></h1>



  <script type="module">

    import { HeaderField } from "/js/HeaderField.js"
    import { Helper } from "/js/Helper.js"
    import { Request } from "/js/Request.js"
    import { DivField } from "/js/DivField.js"
    import { InfoField } from "/js/InfoField.js"
    import { TextField } from "/js/TextField.js"
    import { TelField } from "/js/TelField.js"
    import { EmailField } from "/js/EmailField.js"
    import { SelectionField } from "/js/SelectionField.js"








    const header = document.querySelector("header")
    header.style.position = "fixed"
    header.style.bottom = "0"
    header.style.left = "0"
    header.style.backgroundColor = "white"
    header.style.width = "100%"
    header.style.display = "flex"
    header.style.flexWrap = "wrap"
    header.style.alignItems = "center"
    header.style.justifyContent = "space-between"
    header.style.boxShadow = "0 -3px 5px rgba(0, 0, 0, 0.13)"

    const leftContainer = document.createElement("div")
    leftContainer.style.display = "flex"
    leftContainer.style.alignItems = "center"
    leftContainer.style.flexWrap = "wrap"

    const logo = document.createElement("img")
    logo.src = "/felix/shs/public/ep-logo.svg"
    logo.alt = "Energie Plattform"
    logo.style.width = "55px"
    logo.style.margin = "21px 0 21px 34px"
    logo.style.cursor = "pointer"
    logo.addEventListener("click", () => window.history.back())
    leftContainer.append(logo)

    const name = document.createElement("div")
    name.innerHTML = "Energie Plattform"
    name.style.padding = "21px 34px"
    name.style.fontSize = "21px"
    name.style.color = "#7bc043"
    name.style.cursor = "pointer"
    name.addEventListener("click", () => {


      Helper.popup(async overlay => {

        const header = document.createElement("div")
        header.style.position = "fixed"
        header.style.bottom = "0"
        header.style.left = "0"
        header.style.width = "100%"
        header.style.display = "flex"
        header.style.justifyContent = "flex-start"
        header.style.alignItems = "center"
        header.style.boxShadow = "0px 5px 10px rgba(0, 0, 0, 0.5)"
        header.style.background = "white"
        header.style.cursor = "pointer"
        header.addEventListener("click", () => Helper.removeOverlay(overlay))

        const logo = document.createElement("img")
        logo.src = "/felix/shs/public/ep-logo.svg"
        logo.alt = "EP"
        logo.style.width = "55px"
        logo.style.margin = "34px"
        header.append(logo)
        const title = document.createElement("div")
        title.innerHTML = `/ ${window.location.pathname.split("/")[3]} /`
        title.style.fontWeight = "bold"
        title.style.fontSize = "21px"
        header.append(title)
        overlay.append(header)

        const buttons = document.createElement("div")



        const verify = {}
        verify.url = "/verify/roles/closed/4/"
        verify.state = "exist"
        verify.localStorageEmail = await Request.email()
        verify.location = window.location.href
        verify.referer = document.referrer
        verify.localStorageId = await Request.localStorageId()
        const res = await Request.middleware(verify)

        if (res.status === 200) {
          {
            const button = document.createElement("div")
            button.style.display = "flex"
            button.style.flexWrap = "wrap"
            button.style.justifyContent = "space-between"
            button.style.alignItems = "center"
            button.style.margin = "21px 34px"
            button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
            button.style.borderRadius = "13px"
            button.style.border = "0.3px solid black"
            button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
            button.style.cursor = "pointer"


            button.addEventListener("click", () => {

              Helper.popup(overlay => {

                const header = document.createElement("div")
                header.style.position = "fixed"
                header.style.bottom = "0"
                header.style.left = "0"
                header.style.width = "100%"
                header.style.display = "flex"
                header.style.justifyContent = "flex-start"
                header.style.alignItems = "center"
                header.style.boxShadow = "0px 5px 10px rgba(0, 0, 0, 0.5)"
                header.style.background = "white"
                header.style.cursor = "pointer"
                header.style.zIndex = "1"
                header.addEventListener("click", () => Helper.removeOverlay(overlay))

                const logo = document.createElement("img")
                logo.src = "/felix/shs/public/ep-logo.svg"
                logo.alt = "Energie Plattform"
                logo.style.width = "55px"
                logo.style.margin = "34px"
                header.append(logo)
                const title = document.createElement("div")
                title.innerHTML = "Kunden anlegen"
                title.style.fontWeight = "bold"
                title.style.fontSize = "21px"
                header.append(title)
                overlay.append(header)


                const funnel = document.createElement("div")
                funnel.style.overflow = "auto"
                funnel.style.paddingBottom = "144px"


                const firstname = document.createElement("div")
                firstname.classList.add("firstname")
                funnel.append(firstname)
                overlay.append(funnel)


                const lastname = document.createElement("div")
                lastname.classList.add("lastname")
                funnel.append(lastname)
                overlay.append(funnel)


                const street = document.createElement("div")
                street.classList.add("street")
                funnel.append(street)
                overlay.append(funnel)


                const zip = document.createElement("div")
                zip.classList.add("zip")
                funnel.append(zip)
                overlay.append(funnel)


                const country = document.createElement("div")
                country.classList.add("country")
                funnel.append(country)
                overlay.append(funnel)

                const state = document.createElement("div")
                state.classList.add("state")
                funnel.append(state)
                overlay.append(funnel)

                const phone = document.createElement("div")
                phone.classList.add("phone")
                funnel.append(phone)
                overlay.append(funnel)


                const email = document.createElement("div")
                email.classList.add("email")
                funnel.append(email)
                overlay.append(funnel)


                const checkAndProceed = document.createElement("div")
                checkAndProceed.classList.add("check-and-proceed")
                funnel.append(checkAndProceed)
                overlay.append(funnel)

              })



              const firstnameField = new TextField("firstname")
              .withLabel(label => label.innerHTML = "Vorname")
              .withType(text => {
                text.placeholder = "Max"
                text.required = true
              })
              .onInput(async() => {
                firstnameField.withStorage(value => {
                  // window.sessionStorage.setItem(firstnameField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              firstnameField.withStorage(value => {
                // window.sessionStorage.setItem(firstnameField.name, value)
              })


              const lastnameField = new TextField("lastname")
              .withLabel(label => label.innerHTML = "Nachname")
              .withType(text => {
                text.placeholder = "Muster"
                text.required = true
              })
              .onInput(async() => {
                lastnameField.withStorage(value => {
                  // window.sessionStorage.setItem(lastnameField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              lastnameField.withStorage(value => {
                // window.sessionStorage.setItem(lastnameField.name, value)
              })


              const streetField = new TextField("street")
              .withLabel(label => label.innerHTML = "Straße und Hausnummer")
              .withType(text => {
                text.placeholder = "Wiesentalstr. 43"
                text.required = true
              })
              .onInput(async() => {
                streetField.withStorage(value => {
                  // window.sessionStorage.setItem(streetField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              streetField.withStorage(value => {
                // window.sessionStorage.setItem(streetField.name, value)
              })


              const zipField = new TextField("zip")
              .withLabel(label => label.innerHTML = "Postleitzahl und Stadt")
              .withType(text => {
                text.placeholder = "70190 Stuttgart"
                text.required = true
              })
              .onInput(async() => {
                zipField.withStorage(value => {
                  // window.sessionStorage.setItem(zipField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              zipField.withStorage(value => {
                // window.sessionStorage.setItem(zipField.name, value)
              })


              const stateField = new SelectionField("state")
              .withLabel(label => label.innerHTML = "Bundesland oder Kanton")
              .withOptions(["Baden-Württemberg", "Bayern", "Berlin", "Brandenburg", "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern", "Niedersachsen", "Nordrhein Westfalen", "Rheinland-Pfalz", "Saarland", "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen", "Burgenland", "Kärnten", "Niederösterreich", "Oberösterreich", "Salzburg", "Steiermark", "Tirol", "Vorarlberg", "Wien", "Aargau", "Appenzell Ausserrhoden", "Appenzell Innerrhoden", "Basel-Land", "Basel-Stadt", "Bern", "Fribourg Freiburg", "Genève Geneva", "Glarus", "Graubünden Grischuns Grigioni", "Jura", "Luzern Lucerne", "Neuchâtel", "Nidwalden", "Obwalden", "St.Gallen", "Schaffhausen", "Schwyz", "Solothurn", "Thurgau", "Ticino", "Uri", "Vaud", "Valais Wallis", "Zug", "Zürich"])
              .onInput(async() => {
                stateField.withStorage(value => {
                  // window.sessionStorage.setItem(stateField.name, value[0])
                })
              })
              .fromStorage((name) => [window.sessionStorage.getItem(name)])
              stateField.withStorage(value => {
                // window.sessionStorage.setItem(stateField.name, value[0])
              })



              const countryField = new SelectionField("country")
              .withLabel(label => label.innerHTML = "Land")
              .withOptions(["Deutschland", "Österreich", "Schweiz"])
              .onWindowLoad(async event => await changeState())
              .onChange(async event => await changeState())
              .onInput(async() => {
                countryField.withStorage(value => {
                  // window.sessionStorage.setItem(countryField.name, value[0])
                })
              })
              .fromStorage((name) => [window.sessionStorage.getItem(name)])
              countryField.withStorage(value => {
                // window.sessionStorage.setItem(countryField.name, value[0])
              })

              const phoneField = new TelField("phone")
              .withLabel(label => label.innerHTML = "Telefon")
              .withType(tel => {
                tel.placeholder = "+49 153 1223 1111"
                tel.required = true
              })
              .onInput(async() => {
                phoneField.withStorage(value => {
                  // window.sessionStorage.setItem(phoneField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              phoneField.withStorage(value => {
                // window.sessionStorage.setItem(phoneField.name, value)
              })


              const emailField = new EmailField("email")
              .withLabel(label => label.innerHTML = "E-Mail Adresse")
              .withType(email => {
                email.placeholder = "max.mustermann@web.de"
                email.required = true
              })
              .onInput(async() => {
                emailField.withStorage(value => {
                  // window.sessionStorage.setItem(emailField.name, value)
                })
              })
              .fromStorage((name) => window.sessionStorage.getItem(name))
              emailField.withStorage(value => {
                // window.sessionStorage.setItem(emailField.name, value)
              })


              const checkAndProceedField = new DivField("check-and-proceed")
              .withType(div => {
                div.innerHTML = "Jetzt anlegen"
                div.style.fontSize = "21px"
                div.style.margin = "144px 34px 0 34px"
                div.style.backgroundColor = "#f7aa20"
                div.style.borderRadius = "13px"
                div.style.height = "89px"
                div.style.display = "flex"
                div.style.justifyContent = "center"
                div.style.alignItems = "center"
                div.addEventListener("mouseover", () => div.style.backgroundColor = "#f19d08")
                div.addEventListener("mouseout", () => div.style.backgroundColor = "#f7aa20")
              })
              .onClick(async () => {
                const email = await emailField.withValidValue()
                const firstname = await firstnameField.withValidValue()
                const lastname = await lastnameField.withValidValue()
                const street = await streetField.withValidValue()
                const zip = await zipField.withValidValue()
                const state = (await stateField.withValidValue())[0].value
                const country = (await countryField.withValidValue())[0].value
                const phone = await phoneField.withValidValue()

                {
                  const verify = {}
                  verify.url = "/verify/email/closed/4/"
                  verify.email = email
                  verify.location = window.location.href
                  verify.localStorageEmail = await Request.email()
                  verify.localStorageId = await Request.localStorageId()
                  verify.referer = document.referrer
                  const res = await Request.middleware(verify)

                  if (res.status === 200) {
                    alert("E-Mail Adresse existiert bereits.")
                    Helper.setNotValidStyle(document.querySelector(emailField.inputSelector))
                    throw new Error("email exists")
                  }
                }

                await Request.withVerifiedEmail(await Request.email(), async () => {


                  {
                    const register = {}
                    register.url = "/register/email/closed/4/"
                    register.email = email
                    register.role = "1"
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }

                  {
                    const register = {}
                    register.url = "/register/owner/closed/4/"
                    register.email = email
                    register.firstname = firstname
                    register.lastname = lastname
                    register.street = street
                    register.zip = zip
                    register.country = country
                    register.state = state
                    register.phone = phone
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }

                  {
                    const register = {}
                    register.url = "/register/client/closed/4/"
                    register.email = email
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }


                  alert("Speichern erfolgreich..")
                  window.location.reload()
                })


              })






              async function changeState() {
                const options = await countryField.withValidValue()
                if (options[0].value === "Deutschland") {
                  stateField.withOptions(["Baden-Württemberg", "Bayern", "Berlin", "Brandenburg", "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern", "Niedersachsen", "Nordrhein Westfalen", "Rheinland-Pfalz", "Saarland", "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen"])
                }
                if (options[0].value === "Österreich") {
                  stateField.withOptions(["Burgenland", "Kärnten", "Niederösterreich", "Oberösterreich", "Salzburg", "Steiermark", "Tirol", "Vorarlberg", "Wien"])
                }
                if (options[0].value === "Schweiz") {
                  stateField.withOptions(["Aargau", "Appenzell Ausserrhoden", "Appenzell Innerrhoden", "Basel-Land", "Basel-Stadt", "Bern", "Fribourg Freiburg", "Genève Geneva", "Glarus", "Graubünden Grischuns Grigioni", "Jura", "Luzern Lucerne", "Neuchâtel", "Nidwalden", "Obwalden", "St.Gallen", "Schaffhausen", "Schwyz", "Solothurn", "Thurgau", "Ticino", "Uri", "Vaud", "Valais Wallis", "Zug", "Zürich"])
                }
                stateField.withStorage(options => {
                  // window.sessionStorage.setItem(stateField.name, options[0])
                })
              }





            })


            const icon = document.createElement("img")
            icon.style.margin = "13px 34px"
            icon.style.width = "34px"
            icon.src = "/public/add-icon.svg"
            icon.alt = "Kunden anlegen"
            button.append(icon)

            const title = document.createElement("div")
            title.innerHTML = "Kunden anlegen"
            title.style.margin = "21px 34px"
            title.style.fontSize = "21px"
            button.append(title)

            buttons.append(button)
          }
        }





        {
          const button = document.createElement("div")
          button.style.display = "flex"
          button.style.flexWrap = "wrap"
          button.style.justifyContent = "space-between"
          button.style.alignItems = "center"
          button.style.margin = "21px 34px"
          button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
          button.style.borderRadius = "13px"
          button.style.border = "0.3px solid black"
          button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
          button.style.cursor = "pointer"
          button.addEventListener("click", async () => {

            Helper.popup(overlay => {

              const header = document.createElement("div")
              header.style.position = "fixed"
              header.style.bottom = "0"
              header.style.left = "0"
              header.style.width = "100%"
              header.style.display = "flex"
              header.style.justifyContent = "flex-start"
              header.style.alignItems = "center"
              header.style.boxShadow = "0px 5px 10px rgba(0, 0, 0, 0.5)"
              header.style.background = "white"
              header.style.cursor = "pointer"
              header.style.zIndex = "1"
              header.addEventListener("click", () => Helper.removeOverlay(overlay))

              const logo = document.createElement("img")
              logo.src = "/felix/shs/public/ep-logo.svg"
              logo.alt = "Energie Plattform"
              logo.style.width = "55px"
              logo.style.margin = "34px"
              header.append(logo)
              const title = document.createElement("div")
              title.innerHTML = "Bewerben"
              title.style.fontWeight = "bold"
              title.style.fontSize = "21px"
              header.append(title)
              overlay.append(header)


              const funnel = document.createElement("div")
              funnel.style.overflow = "auto"
              funnel.style.paddingBottom = "144px"

              const promoter = document.createElement("div")
              promoter.classList.add("promoter")
              funnel.append(promoter)
              overlay.append(funnel)

              const preference = document.createElement("div")
              preference.classList.add("preference")
              funnel.append(preference)
              overlay.append(funnel)


              const firstname = document.createElement("div")
              firstname.classList.add("firstname")
              funnel.append(firstname)
              overlay.append(funnel)


              const lastname = document.createElement("div")
              lastname.classList.add("lastname")
              funnel.append(lastname)
              overlay.append(funnel)


              const street = document.createElement("div")
              street.classList.add("street")
              funnel.append(street)
              overlay.append(funnel)


              const zip = document.createElement("div")
              zip.classList.add("zip")
              funnel.append(zip)
              overlay.append(funnel)


              const country = document.createElement("div")
              country.classList.add("country")
              funnel.append(country)
              overlay.append(funnel)

              const state = document.createElement("div")
              state.classList.add("state")
              funnel.append(state)
              overlay.append(funnel)

              const phone = document.createElement("div")
              phone.classList.add("phone")
              funnel.append(phone)
              overlay.append(funnel)


              const email = document.createElement("div")
              email.classList.add("email")
              funnel.append(email)
              overlay.append(funnel)


              const checkAndProceed = document.createElement("div")
              checkAndProceed.classList.add("check-and-proceed")
              funnel.append(checkAndProceed)
              overlay.append(funnel)

              })


              const promoterField = new SelectionField("promoter")
              .withLabel(label => label.innerHTML = "Von welchem Unternehmen möchtest du Angebote erhalten?")
              .onInput(async() => {
              promoterField.withStorage(value => {
                window.localStorage.setItem(promoterField.name, value[0])
              })
              })
              .fromStorage((name) => [window.localStorage.getItem(name)])
              promoterField.withStorage(value => {
              window.localStorage.setItem(promoterField.name, value[0])
              })


              {
                const get = {}
                get.url = "/get/promoter/closed/4/"
                get.localStorageEmail = await Request.email()
                get.localStorageId = await Request.localStorageId()
                get.referer = document.referrer
                get.location = window.location.href
                const res = await Request.middleware(get)

                if (res.status === 200) {
                  const promoter = JSON.parse(res.response)
                  promoterField.withOptions(promoter)
                } else {
                  const input = document.querySelector(promoterField.inputSelector)
                  Helper.setNotValidStyle(input)
                  input.disabled = true
                  alert("Im Moment sind noch keine Angebote veröffentlicht.")
                }
              }



              const preferenceField = new SelectionField("preference")
              .withLabel(label => label.innerHTML = "Wie möchtest du kontaktiert werden?")
              .withOptions(["Telefon", "E-Mail", "Webcall", "Persönlich"])
              .onInput(async() => {
              preferenceField.withStorage(value => {
                window.localStorage.setItem(preferenceField.name, value[0])
              })
              })
              .fromStorage((name) => [window.localStorage.getItem(name)])
              preferenceField.withStorage(value => {
              window.localStorage.setItem(preferenceField.name, value[0])
              })


              const firstnameField = new TextField("firstname")
              .withLabel(label => label.innerHTML = "Vorname")
              .withType(text => {
              text.placeholder = "Max"
              text.required = true
              })
              .onInput(async() => {
              firstnameField.withStorage(value => {
                window.localStorage.setItem(firstnameField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              firstnameField.withStorage(value => {
              window.localStorage.setItem(firstnameField.name, value)
              })


              const lastnameField = new TextField("lastname")
              .withLabel(label => label.innerHTML = "Nachname")
              .withType(text => {
              text.placeholder = "Muster"
              text.required = true
              })
              .onInput(async() => {
              lastnameField.withStorage(value => {
                window.localStorage.setItem(lastnameField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              lastnameField.withStorage(value => {
              window.localStorage.setItem(lastnameField.name, value)
              })


              const streetField = new TextField("street")
              .withLabel(label => label.innerHTML = "Straße und Hausnummer")
              .withType(text => {
              text.placeholder = "Wiesentalstr. 43"
              text.required = true
              })
              .onInput(async() => {
              streetField.withStorage(value => {
                window.localStorage.setItem(streetField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              streetField.withStorage(value => {
              window.localStorage.setItem(streetField.name, value)
              })


              const zipField = new TextField("zip")
              .withLabel(label => label.innerHTML = "Postleitzahl und Stadt")
              .withType(text => {
              text.placeholder = "70190 Stuttgart"
              text.required = true
              })
              .onInput(async() => {
              zipField.withStorage(value => {
                window.localStorage.setItem(zipField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              zipField.withStorage(value => {
              window.localStorage.setItem(zipField.name, value)
              })


              const stateField = new SelectionField("state")
              .withLabel(label => label.innerHTML = "Bundesland oder Kanton")
              .withOptions(["Baden-Württemberg", "Bayern", "Berlin", "Brandenburg", "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern", "Niedersachsen", "Nordrhein Westfalen", "Rheinland-Pfalz", "Saarland", "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen", "Burgenland", "Kärnten", "Niederösterreich", "Oberösterreich", "Salzburg", "Steiermark", "Tirol", "Vorarlberg", "Wien", "Aargau", "Appenzell Ausserrhoden", "Appenzell Innerrhoden", "Basel-Land", "Basel-Stadt", "Bern", "Fribourg Freiburg", "Genève Geneva", "Glarus", "Graubünden Grischuns Grigioni", "Jura", "Luzern Lucerne", "Neuchâtel", "Nidwalden", "Obwalden", "St.Gallen", "Schaffhausen", "Schwyz", "Solothurn", "Thurgau", "Ticino", "Uri", "Vaud", "Valais Wallis", "Zug", "Zürich"])
              .onInput(async() => {
              stateField.withStorage(value => {
                window.localStorage.setItem(stateField.name, value[0])
              })
              })
              .fromStorage((name) => [window.localStorage.getItem(name)])
              stateField.withStorage(value => {
              window.localStorage.setItem(stateField.name, value[0])
              })



              const countryField = new SelectionField("country")
              .withLabel(label => label.innerHTML = "Land")
              .withOptions(["Deutschland", "Österreich", "Schweiz"])
              .onWindowLoad(async event => await changeState())
              .onChange(async event => await changeState())
              .onInput(async() => {
              countryField.withStorage(value => {
                window.localStorage.setItem(countryField.name, value[0])
              })
              })
              .fromStorage((name) => [window.localStorage.getItem(name)])
              countryField.withStorage(value => {
              window.localStorage.setItem(countryField.name, value[0])
              })

              const phoneField = new TelField("phone")
              .withLabel(label => label.innerHTML = "Telefon")
              .withType(tel => {
              tel.placeholder = "+49 153 1223 1111"
              tel.required = true
              })
              .onInput(async() => {
              phoneField.withStorage(value => {
                window.localStorage.setItem(phoneField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              phoneField.withStorage(value => {
              window.localStorage.setItem(phoneField.name, value)
              })


              const emailField = new EmailField("email")
              .withLabel(label => label.innerHTML = "E-Mail Adresse")
              .withType(email => {
              email.placeholder = "max.mustermann@web.de"
              email.required = true
              })
              .onInput(async() => {
              emailField.withStorage(value => {
                window.localStorage.setItem(emailField.name, value)
              })
              })
              .fromStorage((name) => window.localStorage.getItem(name))
              emailField.withStorage(value => {
              window.localStorage.setItem(emailField.name, value)
              })


              const checkAndProceedField = new DivField("check-and-proceed")
              .withType(div => {
              div.innerHTML = "Jetzt bewerben"
              div.style.fontSize = "21px"
              div.style.margin = "144px 34px 0 34px"
              div.style.backgroundColor = "#f7aa20"
              div.style.borderRadius = "13px"
              div.style.height = "89px"
              div.style.display = "flex"
              div.style.justifyContent = "center"
              div.style.alignItems = "center"
              div.addEventListener("mouseover", () => div.style.backgroundColor = "#f19d08")
              div.addEventListener("mouseout", () => div.style.backgroundColor = "#f7aa20")
              })
              .onClick(async () => {

                let promoter
                try {
                  promoter = (await promoterField.withValidValue())[0].value
                } catch (error) {
                  alert("Im Moment sind keine Unternehmen verfügbar. Bitte versuche es später nochmal.")
                  Helper.setNotValidStyle(document.querySelector(promoterField.inputSelector))
                  document.querySelector(promoterField.fieldSelector).scrollIntoView({behavior: 'smooth'})
                  return
                }

                let email
                let preference
                let firstname
                let lastname
                let street
                let zip
                let state
                let country
                let phone
                try {
                  email = await emailField.withValidValue()
                  preference = (await preferenceField.withValidValue())[0].value
                  firstname = await firstnameField.withValidValue()
                  lastname = await lastnameField.withValidValue()
                  street = await streetField.withValidValue()
                  zip = await zipField.withValidValue()
                  state = (await stateField.withValidValue())[0].value
                  country = (await countryField.withValidValue())[0].value
                  phone = await phoneField.withValidValue()
                } catch (error) {
                  alert(`Feld '${error.fieldName}' ist notwendig.`)
                  document.getElementById(error.fieldName).scrollIntoView({behavior: 'smooth'})
                  return
                }


                try {
                  Helper.addOverlay()
                  Helper.setWaitCursor()
                  {
                    const register = {}
                    register.url = "/register/lead/closed/4/"
                    register.state = "open"
                    register.to = promoter
                    register.quality = "unqualified"
                    register.role = "4"
                    register.type = "application"
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }

                  {
                    const register = {}
                    register.url = "/register/preference/closed/4/"
                    register.contact = preference
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }

                  {
                    const register = {}
                    register.url = "/register/owner/closed/4/"
                    register.firstname = firstname
                    register.lastname = lastname
                    register.street = street
                    register.zip = zip
                    register.country = country
                    register.state = state
                    register.phone = phone
                    register.location = window.location.href
                    register.referer = document.referrer
                    register.localStorageEmail = await Request.email()
                    register.localStorageId = await Request.localStorageId()
                    await Request.sequence(register)
                  }

                  alert("Sie erhalten eine E-Mail, sobald Sie freigeschaltet sind.")
                  window.location.reload()
                } catch (error) {
                  alert("Fehler.. Bitte wiederholen.")
                  window.location.reload()
                }

              })

              async function changeState() {
              const options = await countryField.withValidValue()
              if (options[0].value === "Deutschland") {
                stateField.withOptions(["Baden-Württemberg", "Bayern", "Berlin", "Brandenburg", "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern", "Niedersachsen", "Nordrhein Westfalen", "Rheinland-Pfalz", "Saarland", "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen"])
              }
              if (options[0].value === "Österreich") {
                stateField.withOptions(["Burgenland", "Kärnten", "Niederösterreich", "Oberösterreich", "Salzburg", "Steiermark", "Tirol", "Vorarlberg", "Wien"])
              }
              if (options[0].value === "Schweiz") {
                stateField.withOptions(["Aargau", "Appenzell Ausserrhoden", "Appenzell Innerrhoden", "Basel-Land", "Basel-Stadt", "Bern", "Fribourg Freiburg", "Genève Geneva", "Glarus", "Graubünden Grischuns Grigioni", "Jura", "Luzern Lucerne", "Neuchâtel", "Nidwalden", "Obwalden", "St.Gallen", "Schaffhausen", "Schwyz", "Solothurn", "Thurgau", "Ticino", "Uri", "Vaud", "Valais Wallis", "Zug", "Zürich"])
              }
              stateField.withStorage(options => {
                window.localStorage.setItem(stateField.name, options[0])
              })
            }
          })

          const icon = document.createElement("img")
          icon.style.margin = "13px 34px"
          icon.style.width = "34px"
          icon.src = "/public/promote.svg"
          icon.alt = "Bewerben"
          button.append(icon)

          const title = document.createElement("div")
          title.innerHTML = "Bewerben"
          title.style.margin = "21px 34px"
          title.style.fontSize = "21px"
          button.append(title)

          buttons.append(button)
        }


        {
          const verify = {}
          verify.url = "/verify/lead/closed/4/"
          verify.type = "application"
          verify.state = "open"
          verify.localStorageEmail = await Request.email()
          verify.localStorageId = await Request.localStorageId()
          verify.location = window.location.href
          verify.referer = document.referrer
          const res = await Request.middleware(verify)

          if (res.status === 200) {
            const button = document.createElement("div")
            button.style.display = "flex"
            button.style.flexWrap = "wrap"
            button.style.justifyContent = "space-between"
            button.style.alignItems = "center"
            button.style.margin = "21px 34px"
            button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
            button.style.borderRadius = "13px"
            button.style.border = "0.3px solid black"
            button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
            button.style.cursor = "pointer"
            button.addEventListener("click", async () => {

              const confirm = window.confirm("Möchten Sie die Bewerbung wirklich zurückziehen?")
              if (confirm === true) {
                Helper.addOverlay()
                Helper.setWaitCursor()

                {
                  const register = {}
                  register.url = "/register/lead/closed/4/"
                  register.state = "closed"
                  register.localStorageEmail = await Request.email()
                  register.localStorageId = await Request.localStorageId()
                  register.location = window.location.href
                  register.referer = document.referrer
                  await Request.sequence(register)
                }

                alert("Bewerbung erfolgreich zurückgezogen..")
                window.location.reload()
              }

            })

            const icon = document.createElement("img")
            icon.style.margin = "13px 34px"
            icon.style.width = "34px"
            icon.src = "/public/retreet.svg"
            icon.alt = "Zurückziehen"
            button.append(icon)

            const title = document.createElement("div")
            title.innerHTML = "Bewerbung zurückziehen"
            title.style.margin = "21px 34px"
            title.style.fontSize = "21px"
            button.append(title)

            buttons.append(button)
          }
        }





        {
          const button = document.createElement("div")
          button.style.display = "flex"
          button.style.flexWrap = "wrap"
          button.style.justifyContent = "space-between"
          button.style.alignItems = "center"
          button.style.margin = "21px 34px"
          button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
          button.style.borderRadius = "13px"
          button.style.border = "0.3px solid black"
          button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
          button.style.cursor = "pointer"
          button.addEventListener("click", () => window.location.assign("/pana/getyour/nutzervereinbarung/"))

          const icon = document.createElement("img")
          icon.style.margin = "13px 34px"
          icon.style.width = "34px"
          icon.src = "/public/handshake.svg"
          icon.alt = "Nutzervereinbarung"
          button.append(icon)

          const title = document.createElement("div")
          title.innerHTML = "Nutzervereinbarung"
          title.style.margin = "21px 34px"
          title.style.fontSize = "21px"
          button.append(title)

          buttons.append(button)
        }

        {
          const button = document.createElement("div")
          button.style.display = "flex"
          button.style.flexWrap = "wrap"
          button.style.justifyContent = "space-between"
          button.style.alignItems = "center"
          button.style.margin = "21px 34px"
          button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
          button.style.borderRadius = "13px"
          button.style.border = "0.3px solid black"
          button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
          button.style.cursor = "pointer"
          button.addEventListener("click", () => window.location.assign("/pana/getyour/datenschutz/"))

          const icon = document.createElement("img")
          icon.style.margin = "13px 34px"
          icon.style.width = "34px"
          icon.src = "/public/security.svg"
          icon.alt = "Nutzervereinbarung"
          button.append(icon)

          const title = document.createElement("div")
          title.innerHTML = "Datenschutz Richtilinien"
          title.style.margin = "21px 34px"
          title.style.fontSize = "21px"
          button.append(title)

          buttons.append(button)
        }
        {
          const button = document.createElement("div")
          button.style.display = "flex"
          button.style.flexWrap = "wrap"
          button.style.justifyContent = "space-between"
          button.style.alignItems = "center"
          button.style.margin = "21px 34px"
          button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
          button.style.borderRadius = "13px"
          button.style.border = "0.3px solid black"
          button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
          button.style.cursor = "pointer"
          button.addEventListener("click", () => window.location.assign("/pana/getyour/impressum/"))

          const icon = document.createElement("img")
          icon.style.margin = "13px 34px"
          icon.style.width = "34px"
          icon.src = "/public/company.svg"
          icon.alt = "Nutzervereinbarung"
          button.append(icon)

          const title = document.createElement("div")
          title.innerHTML = "Impressum"
          title.style.margin = "21px 34px"
          title.style.fontSize = "21px"
          button.append(title)

          buttons.append(button)
        }

        overlay.append(buttons)
      })
    })
    leftContainer.append(name)
    header.append(leftContainer)


    document.querySelectorAll(".title").forEach(title => {
      title.innerHTML = "Kundenübersicht"
      title.style.margin = "21px 34px"
      title.style.fontWeight = "normal"
    })



    const getClients = {}
    getClients.url = `/get/clients/closed/4/`
    getClients.location = window.location.href
    getClients.referer = document.referrer
    getClients.localStorageEmail = await Request.email()
    getClients.localStorageId = await Request.localStorageId()
    const res = await Request.middleware(getClients)

    if (res.status === 200) {
      const clientlist = document.createElement("div")
      clientlist.style.paddingBottom = "144px"

      const clients = JSON.parse(res.response)

      if (clients.length === 0) {
        clientlist.innerHTML = "Keine Kunden angelegt."
        clientlist.style.color = "gray"
        clientlist.style.display = "flex"
        clientlist.style.justifyContent = "center"
        clientlist.style.alignItems = "center"
        clientlist.style.height = "50vh"
      }

      for (let i = 0; i < clients.length; i++) {
        const client = clients[i]

        const item = document.createElement("div")
        item.classList.add("checklist-item")
        item.style.margin = "34px"

        const itemHeader = document.createElement("div")
        itemHeader.classList.add("item-header")
        itemHeader.style.display = "flex"
        itemHeader.style.borderTopRightRadius = "21px"
        itemHeader.style.borderTopLeftRadius = "21px"
        itemHeader.style.borderBottomLeftRadius = "21px"
        itemHeader.style.backgroundColor = "#d1d0d0"
        itemHeader.style.cursor = "pointer"
        itemHeader.addEventListener("click", async () => {


          {
            const verify = {}
            verify.url = "/verify/seller/closed/4/"
            verify.state = "active"
            verify.localStorageEmail = await Request.email()
            verify.localStorageId = await Request.localStorageId()
            verify.location = window.location.href
            verify.referer = document.referrer
            const res = await Request.middleware(verify)

            if (res.status === 200) {

              Helper.popup(overlay => {

                const header = document.createElement("div")
                header.style.position = "fixed"
                header.style.bottom = "0"
                header.style.left = "0"
                header.style.width = "100%"
                header.style.display = "flex"
                header.style.justifyContent = "flex-start"
                header.style.alignItems = "center"
                header.style.boxShadow = "0px 5px 10px rgba(0, 0, 0, 0.5)"
                header.style.background = "white"
                header.style.cursor = "pointer"
                header.addEventListener("click", () => Helper.removeOverlay(overlay))

                const logo = document.createElement("img")
                logo.src = "/felix/shs/public/ep-logo.svg"
                logo.alt = "Energie Plattform"
                logo.style.width = "55px"
                logo.style.margin = "34px"
                header.append(logo)
                const title = document.createElement("div")
                title.innerHTML = `${client.firstname} ${client.lastname}`
                title.style.fontWeight = "bold"
                title.style.fontSize = "21px"
                header.append(title)
                overlay.append(header)



                const buttons = document.createElement("div")
                buttons.style.overflow = "auto"

                {
                  const button = document.createElement("div")
                  button.style.display = "flex"
                  button.style.flexWrap = "wrap"
                  button.style.justifyContent = "space-between"
                  button.style.alignItems = "center"
                  button.style.margin = "21px 34px"
                  button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
                  button.style.borderRadius = "13px"
                  button.style.border = "0.3px solid black"
                  button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
                  button.style.cursor = "pointer"
                  button.addEventListener("click", () => {

                    Helper.popup(overlay => {

                      const header = document.createElement("div")
                      header.style.position = "fixed"
                      header.style.bottom = "0"
                      header.style.left = "0"
                      header.style.width = "100%"
                      header.style.display = "flex"
                      header.style.justifyContent = "flex-start"
                      header.style.alignItems = "center"
                      header.style.boxShadow = "0px 5px 10px rgba(0, 0, 0, 0.5)"
                      header.style.background = "white"
                      header.style.cursor = "pointer"
                      header.addEventListener("click", () => Helper.removeOverlay(overlay))

                      const logo = document.createElement("img")
                      logo.src = "/felix/shs/public/ep-logo.svg"
                      logo.alt = "Energie Plattform"
                      logo.style.width = "55px"
                      logo.style.margin = "34px"
                      header.append(logo)
                      const title = document.createElement("div")
                      title.innerHTML = "Funnel wählen"
                      title.style.fontWeight = "bold"
                      title.style.fontSize = "21px"
                      header.append(title)
                      overlay.append(header)


                      const buttons = document.createElement("div")


                      {
                        const button = document.createElement("div")
                        button.style.display = "flex"
                        button.style.flexWrap = "wrap"
                        button.style.justifyContent = "space-between"
                        button.style.alignItems = "center"
                        button.style.margin = "21px 34px"
                        button.style.backgroundColor = "rgba(255, 255, 255, 0.6)"
                        button.style.borderRadius = "13px"
                        button.style.border = "0.3px solid black"
                        button.style.boxShadow = "0 3px 6px rgba(0, 0, 0, 0.16)"
                        button.style.cursor = "pointer"
                        button.addEventListener("click", () => window.location.assign(`/felix/ep/qualifizierung/${client.id}/4/`))

                        const icon = document.createElement("img")
                        icon.style.margin = "13px 34px"
                        icon.style.width = "34px"
                        icon.src = "/felix/shs/public/ep-logo.svg"
                        icon.alt = "Energie Plattform"
                        button.append(icon)

                        const title = document.createElement("div")
                        title.innerHTML = "Energie Plattform"
                        title.style.margin = "21px 34px"
                        title.style.fontSize = "21px"
                        button.append(title)

                        buttons.append(button)
                      }
                      overlay.append(buttons)
                    })
                  })

                  const icon = document.createElement("img")
                  icon.style.margin = "13px 34px"
                  icon.style.width = "34px"
                  icon.src = "/public/funnel.svg"
                  icon.alt = "Kunde qualifizieren"
                  button.append(icon)

                  const title = document.createElement("div")
                  title.innerHTML = "Qualifizieren"
                  title.style.margin = "21px 34px"
                  title.style.fontSize = "21px"
                  button.append(title)

                  buttons.append(button)
                }




                overlay.append(buttons)



              })

            } else {
              alert("Um diese Funktion nutzen zu können, müssen Sie sich erst um Angebote bewerben. Sollten Sie Ihren Promoter nicht in der Liste finden, dann schreiben Sie uns unter 'datenschutz@get-your.de' und wir werden uns mit Ihrem Promoter in Verbindung setzen. Sobald Sie der Promoter freigeschaltet hat, erhalten Sie eine Nachricht per E-Mail und die Funktion wird für Sie aktiviert.")
            }
          }




        })

        const itemState = document.createElement("div")
        itemState.classList.add("item-state")
        itemState.style.display = "flex"
        itemState.style.justifyContent = "center"
        itemState.style.alignItems = "center"
        itemState.style.width = "89px"
        itemState.style.height = "89px"
        itemState.style.backgroundColor = "#c6c6c6"
        itemState.style.fontSize = "34px"

        if (client.state === "offen") {
          itemState.style.backgroundColor = "#006f39"
          itemState.style.color = "#ffffff"
        }
        itemState.style.borderTopLeftRadius = "21px"
        itemState.style.borderBottomLeftRadius = "21px"

        const itemIndex = document.createElement("div")
        itemIndex.classList.add("item-index")
        itemIndex.innerHTML = client.reputation
        itemIndex.style.fontSize = "21px"

        itemState.append(itemIndex)


        const itemTitle = document.createElement("div")
        itemTitle.classList.add("item-title")
        itemTitle.style.alignSelf = "center"
        itemTitle.style.marginLeft = "13px"
        itemTitle.innerHTML = `${client.firstname} ${client.lastname}`
        itemTitle.style.fontSize = "21px"

        itemHeader.append(itemState, itemTitle)
        item.append(itemHeader)


        const itemBody = document.createElement("div")
        itemBody.classList.add("item-body")
        itemBody.style.marginLeft = "8%"
        itemBody.style.backgroundColor = "#dbdbdb"
        itemBody.style.borderBottomRightRadius = "21px"
        itemBody.style.borderBottomLeftRadius = "21px"
        itemBody.style.padding = "21px"
        itemBody.style.display = "flex"
        itemBody.style.flexDirection = "column"
        itemBody.style.boxShadow = "0 3px 5px rgba(0, 0, 0, 0.13)"

        const buttons = document.createElement("div")
        buttons.style.display = "flex"
        buttons.style.alignItems = "center"

        {
          if (client.phone !== undefined) {
            const button = document.createElement("img")
            button.src = "/public/phone-out.svg"
            button.alt = "Anrufen"
            button.style.width = "55px"
            button.style.padding = "13px"
            button.style.cursor = "pointer"
            button.addEventListener("click", () => {
              const a = document.createElement("a")
              a.href = `tel:${client.phone}`
              a.click()
            })
            buttons.append(button)
          }
        }

        {
          if (client.email !== undefined) {
            const button = document.createElement("img")
            button.src = "/public/mailto.svg"
            button.alt = "E-Mail schreiben"
            button.style.width = "55px"
            button.style.padding = "13px"
            button.style.cursor = "pointer"
            button.addEventListener("click", () => {
              const a = document.createElement("a")
              a.href = `mailto:${client.email}`
              a.click()
            })
            buttons.append(button)
          }
        }

        {
          if (client.street !== undefined && client.zip !== undefined) {
            const button = document.createElement("img")
            button.src = "/public/maps.svg"
            button.alt = "Navigieren"
            button.style.width = "55px"
            button.style.padding = "13px"
            button.style.cursor = "pointer"
            button.addEventListener("click", () => {
              const a = document.createElement("a")
              a.target = "_blank"
              a.href = `https://maps.google.com/?q=${client.zip}, ${client.street}`
              a.click()
            })
            buttons.append(button)
          }
        }



        itemBody.append(buttons)

        item.append(itemBody)
        clientlist.append(item)


      }
      document.body.append(clientlist)
    }


  </script>
</body>


</html>
